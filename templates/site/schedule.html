{% extends "site/base.html" %}
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}
{% block title %}
  {% trans 'Schedule' %}
{% endblock %}
{% block head %}
  <!--Select2 Bootstrap5 theme-->
  <!-- Styles -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css"/>
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.rtl.min.css"/>

{% endblock head %}
{% block content %}
  <div class="px-sm-5 px-2 py-3">
    <div id="sessions">

    </div>
  </div>
{% endblock content %}
{% block script %}
  <script>
    $(document).ready(function () {
      $.ajax({
        url: "{% url 'site_schedule_sessions'%}",
        method: "GET",
        success: function (response) {
          const $sessions = $('#sessions');
          Object.entries(response).forEach(([key, sessions]) => {
            $sessions.append(`<h5>${key}</h5>`);
            const $table = $(
                "<table class='table table-striped table-bordered'>" +
                "<thead>" +
                "<tr>" +
                "<th scope='col'>{% trans 'Time' %}</th>" +
                "<th scope='col'>{% trans 'Film' %}</th>" +
                "<th scope='col'>{% trans 'Hall' %}</th>" +
                "<th scope='col'>{% trans 'Price' %}</th>" +
                "<th scope='col'>{% trans 'Book a ticket' %}</th>" +
                "</tr>" +
                "</thead>" +
                "<tbody>" +
                "</tbody>" +
                "</table>"
              )
            ;
            $sessions.append($table);
            for (const session of sessions) {
              $table.children('tbody').append(
                "<tr>" +
                `<td scope='col'>${session.date}</td>` +
                `<td scope='col'>{% if LANGUAGE_CODE == "uk" %}${session.film_name_uk}{% else %}
                  ${session.film_name_en}{% endif %}</td>` +
                `<td scope='col'>{% if LANGUAGE_CODE == "uk" %}${session.hall_name_uk}{% else %}
                  ${session.hall_name_en}{% endif %}</td>` +
                `<td scope='col'>${session.price}</td>` +
                "<td scope='col'>{% trans 'Book a ticket' %}</td>" +
                "</tr>"
              )
            }

          })
        }
      })
    })
  </script>
{% endblock script %}
