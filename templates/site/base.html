{% load static %}
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>
    {% block title %}
    {% endblock %}
  </title>
  <!--Bootstrap5 CSS-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="{% static 'plugins/fontawesome-free/css/all.min.css' %}">
  <!--SweetAlert2 Bootstrap theme-->
  <link rel="stylesheet" href="{% static 'plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css' %}">
  <style>
    @media (min-width: 992px) {
      .dropdown {
        padding: 0 !important;
      }
    }
  </style>
  {% block head %}
  {% endblock head %}
</head>
<body style="background-color:#f4f6f9">
<nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
  <div class="container">

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link link-dark px-2" aria-current="page">{% translate 'Billboard' %}</a></li>
        <li class="nav-item"><a class="nav-link link-dark px-2">{% translate 'Schedule' %}</a></li>
        <li class="nav-item"><a class="nav-link link-dark px-2">{% translate 'Soon' %}</a></li>
        <li class="nav-item"><a class="nav-link link-dark px-2">{% translate 'Contacts' %}</a></li>
        <li class="nav-item"><a class="nav-link link-dark px-2">{% translate 'Cinemas' %}</a></li>
        <li class="nav-item"><a class="nav-link link-dark px-2">{% translate 'News' %}</a></li>
        <li class="nav-item"><a class="nav-link link-dark px-2">{% translate 'Promotions' %}</a></li>
        <li class="nav-item dropdown p-2">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown"
             aria-expanded="false">
            {% translate 'About Cinema' %}
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
            <li><a class="dropdown-item">Cafe-Bars</a></li>
            <li><a class="dropdown-item">VIP Halls</a></li>
            <li><a class="dropdown-item">Child Rooms</a></li>
            <li><a class="dropdown-item">For Advertisers</a></li>
            <li><a class="dropdown-item">Mobile Applications</a></li>
          </ul>
        </li>
        <li class="nav-item">
          <select id="language-select" class="form-select mx-2" aria-label="Language select">
            <option
              value="en"
              {% if LANGUAGE_CODE == "en" %}
              selected
              {% endif %}
            >EN
            </option>
            <option
              value="uk"
              {% if LANGUAGE_CODE == "uk" %}
              selected
              {% endif %}
            >UK
            </option>
          </select>
        </li>
      </ul>
      <div class="d-flex mx-2">
        {% if request.user.is_authenticated %}
          <span class="nav-link" style="padding-left: 4px !important;">
          <i class="nav-icon fas fa-user"></i>
            {{ request.user.email }}
          </span>
          <form method="post" action="{% url 'site_authentication_logout' %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-outline-primary btn-block">{% translate 'Logout' %}</button>
          </form>
        {% else %}
          <a class="text-decoration-none" style="margin-left: 8px;"
             href="{% url 'site_authentication_login' %}">{% translate 'Login' %}</a>
          <a class="text-decoration-none" style="margin-left: 8px;"
             href="{% url 'site_authentication_register' %}">{% translate 'Register' %}</a>
        {% endif %}
      </div>
    </div>
  </div>
</nav>
<header class="py-3 mb-4 border-bottom">
  <div class="container d-flex flex-wrap justify-content-center">
    <a href="{% url 'site_main' %}"
       class="d-flex align-items-center mb-3 mb-lg-0 me-lg-auto text-dark text-decoration-none">
      <span class="fs-4"> <i class="fas fa-film"></i>Kino</span>
    </a>
    <form class="col-12 col-lg-auto mb-3 mb-lg-0" role="search">
      <input type="search" class="form-control" placeholder="Search..." aria-label="Search">
    </form>
  </div>
</header>
{% block content %}
{% endblock content %}
</body>
</html>
<!--Bootstrap5 JS Bundle-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
<!-- jQuery -->
<script src="{% static 'plugins/jquery/jquery.min.js' %}"></script>
<!--Sweet Alert-->
<script src="{% static 'plugins/sweetalert2/sweetalert2.all.min.js' %}"></script>
<!--Toast alert if retrieved message or got form with errors-->
<script>
  $(function () {
    const Toast = Swal.mixin({
      toast: true,
      position: 'bottom-start',
      showConfirmButton: false,
      timer: 3000
    });

    {% for _, errors in form.errors.items %}
      {% for error in errors %}
        Toast.fire({
          icon: "error",
          title: "{{ error|escape }}"
        })
      {% endfor %}
    {% endfor %}

    {% if messages %}
      {% for message in messages %}
        Toast.fire({
          icon: "{{ message.tags }}",
          title: "{{ message }}"
        })
      {% endfor %}
    {% endif %}
  })


  $('#language-select').change(function () {
    const selectedLanguage = $(this).val();

    $.ajax({
      url: '{% url "site_change_language" %}',
      type: 'POST',
      data: {
        'language': selectedLanguage,
        'csrfmiddlewaretoken': '{{ csrf_token }}'
      },
      success: function (response) {
        if (response.status === 'success') {
          location.reload();
        }
      }
    })
  })
</script>
{% block script %}
{% endblock %}
